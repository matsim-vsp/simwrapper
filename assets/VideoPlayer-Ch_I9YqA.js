import{d as a,g as o,n as r}from"./index-D_sw2g-2.js";const n=a({name:"VideoPlayerPlugin",props:{root:{type:String,required:!0},subfolder:{type:String,required:!0},yamlConfig:String,config:Object,thumbnail:Boolean},data:()=>({movieSource:"",title:"",myState:{},fileApi:null,sources:[],playerOptions:{autoplay:!1,controls:!0,fluid:!1,language:o.state.locale,muted:!1,playbackRates:[.5,1,1.5,2,5],playsInline:!0,preload:"metadata",responsive:!0}}),beforeDestroy(){this.thumbnail||o.commit("setFullScreen",!1)},mounted(){this.fileApi=this.getFileSystem(this.root),this.myState={subfolder:this.subfolder,yamlConfig:this.yamlConfig,thumbnail:this.thumbnail,imageData:""},this.getVizDetails(),!this.thumbnail&&(this.playerOptions.fluid=!!this.thumbnail,this.thumbnail||o.commit("setFullScreen",!0),this.yamlConfig?(this.myState.subfolder=this.subfolder,this.myState.yamlConfig=this.yamlConfig,this.buildMovieSource()):this.buildRouteFromUrl())},watch:{yamlConfig(){this.myState.yamlConfig=this.yamlConfig,this.getVizDetails()},subfolder(){this.myState.subfolder=this.subfolder,this.getVizDetails()}},methods:{buildMovieSource(){this.movieSource=`${this.fileApi?.baseURL}/${this.myState.subfolder}/${this.myState.yamlConfig}`},getFileSystem(e){const t=this.$store.state.svnProjects.filter(i=>i.slug===e);if(t.length===0)throw console.log("no such project"),Error;return t[0]},async buildRouteFromUrl(){const e=this.$route.params;if(!e.project||!e.pathMatch){console.log("I CANT EVEN: NO PROJECT/PARHMATCH");return}this.fileApi=this.getFileSystem(e.project);const t=1+e.pathMatch.lastIndexOf("/"),i=e.pathMatch.substring(0,t),s=e.pathMatch.substring(t);this.myState.subfolder=i,this.myState.yamlConfig=s,this.buildMovieSource()},async generateBreadcrumbs(){const e=this.getFileSystem(this.$route.params.project);if(!e)return[];const t=[{label:e.name,url:"/"+e.slug}],i=this.myState.subfolder.split("/");let s="/";for(const l of i)l&&(s+=l+"/",t.push({label:l,url:"/"+e.slug+s}));return o.commit("setBreadCrumbs",t),t},async getVizDetails(){this.title=this.myState.yamlConfig.replace(/_/g," "),this.title=this.title.substring(0,this.title.lastIndexOf(".")),this.title&&this.$emit("title",this.title)}}});var u=function(){var t=this,i=t._self._c;return t._self._setupProxy,i("div",{staticClass:"video-plugin-container",class:{thumbnail:t.thumbnail}},[t.thumbnail?t._e():i("h3",[t._v(t._s(t.title))]),t.thumbnail?t._e():i("div",{staticClass:"vid-container"},[i("video",{attrs:{controls:t.playerOptions.controls,loop:t.playerOptions.loop,allowfullscreen:!0,autoplay:t.playerOptions.autoplay},domProps:{muted:t.playerOptions.muted}},[i("source",{attrs:{src:t.movieSource,type:"video/mp4"}}),i("p",[t._v("Video tag not supported. Download the videoÂ "),i("a",{attrs:{href:t.movieSource,target:"_blank"}},[t._v("here")])])])])])},h=[],m=r(n,u,h,!1,null,"37832741");const f=m.exports;export{f as default};
