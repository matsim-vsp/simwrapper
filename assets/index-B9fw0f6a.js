let Qr=Cr,oe=Cr,ae=Cr,le=he,ce=pe;typeof Uint8Array<"u"&&(Qr=function(f){return new Uint8Array(f)},oe=function(f){return new Uint16Array(f)},ae=function(f){return new Uint32Array(f)},le=function(f,t){if(f.length>=t)return f;var n=new f.constructor(t);return n.set(f),n},ce=function(f,t){var n;switch(t){case 16:n=oe(f.length);break;case 32:n=ae(f.length);break;default:throw new Error("invalid array width!")}return n.set(f),n});function Cr(f){for(var t=new Array(f),n=-1;++n<f;)t[n]=0;return t}function he(f,t){for(var n=f.length;n<t;)f[n++]=0;return f}function pe(f,t){if(t>32)throw new Error("invalid array width!");return f}function ar(f){this.length=f,this.subarrays=1,this.width=8,this.masks={0:0},this[0]=Qr(f)}ar.prototype.lengthen=function(f){var t,n;for(t=0,n=this.subarrays;t<n;++t)this[t]=le(this[t],f);this.length=f};ar.prototype.add=function(){var f,t,n,u,s;for(u=0,s=this.subarrays;u<s;++u)if(f=this.masks[u],t=this.width-32*u,n=(~f&f+1)>>>0,!(t>=32&&!n))return t<32&&n&1<<t&&(this[u]=ce(this[u],t<<=1),this.width=32*u+t),this.masks[u]|=n,{offset:u,one:n};return this[this.subarrays]=Qr(this.length),this.masks[this.subarrays]=1,this.width+=8,{offset:this.subarrays++,one:1}};ar.prototype.copy=function(f,t){var n,u;for(n=0,u=this.subarrays;n<u;++n)this[n][f]=this[n][t]};ar.prototype.truncate=function(f){var t,n;for(t=0,n=this.subarrays;t<n;++t)for(var u=this.length-1;u>=f;u--)this[t][u]=0;this.length=f};ar.prototype.zero=function(f){var t,n;for(t=0,n=this.subarrays;t<n;++t)if(this[t][f])return!1;return!0};ar.prototype.zeroExcept=function(f,t,n){var u,s;for(u=0,s=this.subarrays;u<s;++u)if(u===t?this[u][f]&n:this[u][f])return!1;return!0};ar.prototype.zeroExceptMask=function(f,t){var n,u;for(n=0,u=this.subarrays;n<u;++n)if(this[n][f]&t[n])return!1;return!0};ar.prototype.only=function(f,t,n){var u,s;for(u=0,s=this.subarrays;u<s;++u)if(this[u][f]!=(u===t?n:0))return!1;return!0};ar.prototype.onlyExcept=function(f,t,n,u,s){var p,E,m;for(E=0,m=this.subarrays;E<m;++E)if(p=this[E][f],E===t&&(p=(p&n)>>>0),p!=(E===u?s:0))return!1;return!0};const wr={array8:Cr,array16:Cr,array32:Cr,arrayLengthen:he,arrayWiden:pe,bitarray:ar},be=(f,t)=>function(n){var u=n.length;return[f.left(n,t,0,u),f.right(n,t,0,u)]},Ue=(f,t)=>{var n=t[0],u=t[1];return function(s){var p=s.length;return[f.left(s,n,0,p),f.left(s,u,0,p)]}},We=f=>[0,f.length],Sr={filterExact:be,filterRange:Ue,filterAll:We},Lr=f=>f,or=()=>null,Ur=()=>0;function ve(f){function t(s,p,E){for(var m=E-p,Y=(m>>>1)+1;--Y>0;)u(s,Y,m,p);return s}function n(s,p,E){for(var m=E-p,Y;--m>0;)Y=s[p],s[p]=s[p+m],s[p+m]=Y,u(s,1,m,p);return s}function u(s,p,E,m){for(var Y=s[--m+p],hr=f(Y),K;(K=p<<1)<=E&&(K<E&&f(s[m+K])>f(s[m+K+1])&&K++,!(hr<=f(s[m+K])));)s[m+p]=s[m+K],p=K;s[m+p]=Y}return t.sort=n,t}const Dr=ve(Lr);Dr.by=ve;function de(f){var t=Dr.by(f);function n(u,s,p,E){var m=new Array(E=Math.min(p-s,E)),Y,hr,K;for(hr=0;hr<E;++hr)m[hr]=u[s++];if(t(m,0,E),s<p){Y=f(m[0]);do f(K=u[s])>Y&&(m[0]=K,Y=f(t(m,0,E)[0]));while(++s<p)}return m}return n}const Tr=de(Lr);Tr.by=de;function ge(f){function t(u,s,p,E){for(;p<E;){var m=p+E>>>1;f(u[m])<s?p=m+1:E=m}return p}function n(u,s,p,E){for(;p<E;){var m=p+E>>>1;s<f(u[m])?E=m:p=m+1}return p}return n.right=n,n.left=t,n}const _r=ge(Lr);_r.by=ge;const Wr=(f,t,n)=>{for(var u=0,s=t.length,p=n?JSON.parse(JSON.stringify(f)):new Array(s);u<s;++u)p[u]=f[t[u]];return p},_e=f=>f+1,De=f=>f-1,Ve=f=>function(t,n){return t+ +f(n)},Je=f=>function(t,n){return t-f(n)},yr={reduceIncrement:_e,reduceDecrement:De,reduceAdd:Ve,reduceSubtract:Je};function Pe(f,t,n,u,s){for(s in u=(n=n.split(".")).splice(-1,1),n)t=t[n[s]]=t[n[s]]||{};return f(t,u)}const $e=(f,t)=>{const n=f[t];return typeof n=="function"?n.call(f):n},qe=/\[([\w\d]+)\]/g,Xe=(f,t)=>Pe($e,f,t.replace(qe,".$1"));var mr=-1;Vr.heap=Dr;Vr.heapselect=Tr;Vr.bisect=_r;Vr.permute=Wr;function Vr(){var f={add:Y,remove:hr,dimension:me,groupAll:we,size:Ae,all:xe,allFiltered:Ee,onChange:ze,isElementFiltered:ye},t=[],n=0,u,s=[],p=[],E=[],m=[];u=new wr.bitarray(0);function Y(F){var a=n,C=F.length;return C&&(t=t.concat(F),u.lengthen(n+=C),p.forEach(function(P){P(F,a,C)}),Nr("dataAdded")),f}function hr(F){for(var a=new Array(n),C=[],P=typeof F=="function",y=function(k){return P?F(t[k],k):u.zero(k)},O=0,v=0;O<n;++O)y(O)?(C.push(O),a[O]=mr):a[O]=v++;s.forEach(function(k){k(-1,-1,[],C,!0)}),E.forEach(function(k){k(a)});for(var ur=0,z=0;ur<n;++ur)a[ur]!==mr&&(ur!==z&&(u.copy(z,ur),t[z]=t[ur]),++z);t.length=n=z,u.truncate(z),Nr("dataRemoved")}function K(F){var a,C,P,y,O=Array(u.subarrays);for(a=0;a<u.subarrays;a++)O[a]=-1;for(C=0,P=F.length;C<P;C++)y=F[C].id(),O[y>>7]&=~(1<<(y&63));return O}function ye(F,a){var C=K(a||[]);return u.zeroExceptMask(F,C)}function me(F,a){if(typeof F=="string"){var C=F;F=function(i){return Xe(i,C)}}var P={filter:ke,filterExact:Kr,filterRange:Gr,filterFunction:jr,filterAll:qr,currentFilter:Ie,hasCurrentFilter:Fe,top:Oe,bottom:Se,group:ee,groupAll:Ce,dispose:te,remove:te,accessor:F,id:function(){return ur}},y,O,v,ur,z,k,b,D,V,W,w=[],pr=function(i){return Hr(i).sort(function(l,e){var r=b[l],d=b[e];return r<d?-1:r>d?1:l-e})},U=Sr.filterAll,fr,vr,G,sr=[],lr=[],rr=0,er=0,Ar=0,dr;p.unshift(Jr),p.push(Pr),E.push(Zr);var Yr=u.add();v=Yr.offset,y=Yr.one,O=~y,ur=v<<7|Math.log(y)/Math.log(2),Jr(t,0,n),Pr(t,0,n);function Jr(i,l,e){var r,d;if(a){Ar=0,Z=0,dr=[];for(var c=0;c<i.length;c++)for(Z=0,dr=F(i[c]);Z<dr.length;Z++)Ar++;b=[],r=Hr(i.length),d=kr(Ar,1);for(var h=Hr(Ar),L=0,$=0;$<i.length;$++){if(dr=F(i[$]),!dr.length){r[$]=0,w.push($+l);continue}for(r[$]=dr.length,Z=0;Z<dr.length;Z++)b.push(dr[Z]),h[L]=$,L++}var q=pr(Ar);b=Wr(b,q),D=Wr(h,q)}else b=i.map(F),D=pr(e),b=Wr(b,D);var _=U(b),j=_[0],N=_[1],R,X,tr;if(a)if(e=Ar,fr)for(R=0;R<e;++R)fr(b[R],R)||(--r[D[R]]===0&&(u[v][D[R]+l]|=y),d[R]=1);else{for(X=0;X<j;++X)--r[D[X]]===0&&(u[v][D[X]+l]|=y),d[X]=1;for(tr=N;tr<e;++tr)--r[D[tr]]===0&&(u[v][D[tr]+l]|=y),d[tr]=1}else if(fr)for(R=0;R<e;++R)fr(b[R],R)||(u[v][D[R]+l]|=y);else{for(X=0;X<j;++X)u[v][D[X]+l]|=y;for(tr=N;tr<e;++tr)u[v][D[tr]+l]|=y}if(!l){z=b,k=D,V=r,W=d,rr=j,er=N;return}var gr=z,Ir=k,Rr=W,Fr,nr=0;if(c=0,a&&(Fr=l,l=gr.length,e=Ar),z=a?new Array(l+e):new Array(n),k=a?new Array(l+e):kr(n,n),a&&(W=kr(l+e,1)),a){var Mr=V.length;V=wr.arrayLengthen(V,n);for(var Z=0;Z+Mr<n;Z++)V[Z+Mr]=r[Z]}for(var B=0;c<l&&nr<e;++B)gr[c]<b[nr]?(z[B]=gr[c],a&&(W[B]=Rr[c]),k[B]=Ir[c++]):(z[B]=b[nr],a&&(W[B]=d[nr]),k[B]=D[nr++]+(a?Fr:l));for(;c<l;++c,++B)z[B]=gr[c],a&&(W[B]=Rr[c]),k[B]=Ir[c];for(;nr<e;++nr,++B)z[B]=b[nr],a&&(W[B]=d[nr]),k[B]=D[nr]+(a?Fr:l);_=U(z),rr=_[0],er=_[1]}function Pr(i,l,e){sr.forEach(function(r){r(b,D,l,e)}),b=D=null}function Zr(i){if(a){for(var l=0,e=0;l<w.length;l++)i[w[l]]!==mr&&(w[e]=i[w[l]],e++);for(w.length=e,l=0,e=0;l<n;l++)i[l]!==mr&&(e!==l&&(V[e]=V[l]),e++);V=V.slice(0,e)}for(var r=z.length,d=0,c=0,h;d<r;++d)h=k[d],i[h]!==mr&&(d!==c&&(z[c]=z[d]),k[c]=i[h],a&&(W[c]=W[d]),++c);for(z.length=c,a&&(W=W.slice(0,c));c<r;)k[c++]=0;var L=U(z);rr=L[0],er=L[1]}function $r(i){var l=i[0],e=i[1];if(fr)return fr=null,re(function(N,R){return l<=R&&R<e},i[0]===0&&i[1]===z.length),rr=l,er=e,P;var r,d,c,h=[],L=[],$=[],q=[];if(l<rr)for(r=l,d=Math.min(rr,e);r<d;++r)h.push(k[r]),$.push(r);else if(l>rr)for(r=rr,d=Math.min(l,er);r<d;++r)L.push(k[r]),q.push(r);if(e>er)for(r=Math.max(l,er),d=e;r<d;++r)h.push(k[r]),$.push(r);else if(e<er)for(r=Math.max(rr,e),d=er;r<d;++r)L.push(k[r]),q.push(r);if(a){var _=[],j=[];for(r=0;r<h.length;r++)V[h[r]]++,W[$[r]]=0,V[h[r]]===1&&(u[v][h[r]]^=y,_.push(h[r]));for(r=0;r<L.length;r++)V[L[r]]--,W[q[r]]=1,V[L[r]]===0&&(u[v][L[r]]^=y,j.push(L[r]));if(h=_,L=j,U===Sr.filterAll)for(r=0;r<w.length;r++)u[v][c=w[r]]&y&&(u[v][c]^=y,h.push(c));else for(r=0;r<w.length;r++)u[v][c=w[r]]&y||(u[v][c]^=y,L.push(c))}else{for(r=0;r<h.length;r++)u[v][h[r]]^=y;for(r=0;r<L.length;r++)u[v][L[r]]^=y}return rr=l,er=e,s.forEach(function(N){N(y,v,h,L)}),Nr("filtered"),P}function ke(i){return i==null?qr():Array.isArray(i)?Gr(i):typeof i=="function"?jr(i):Kr(i)}function Kr(i){return vr=i,G=!0,$r((U=Sr.filterExact(_r,i))(z))}function Gr(i){return vr=i,G=!0,$r((U=Sr.filterRange(_r,i))(z))}function qr(){return vr=void 0,G=!1,$r((U=Sr.filterAll)(z))}function jr(i){vr=i,G=!0,fr=i,U=Sr.filterAll,re(i,!1);var l=U(z);return rr=l[0],er=l[1],P}function re(i,l){var e,r,d,c=[],h=[],L=[],$=[],q=z.length;if(!a)for(e=0;e<q;++e)!(u[v][r=k[e]]&y)^!!(d=i(z[e],e))&&(d?c.push(r):h.push(r));if(a)for(e=0;e<q;++e)i(z[e],e)?(c.push(k[e]),L.push(e)):(h.push(k[e]),$.push(e));if(a){var _=[],j=[];for(e=0;e<c.length;e++)W[L[e]]===1&&(V[c[e]]++,W[L[e]]=0,V[c[e]]===1&&(u[v][c[e]]^=y,_.push(c[e])));for(e=0;e<h.length;e++)W[$[e]]===0&&(V[h[e]]--,W[$[e]]=1,V[h[e]]===0&&(u[v][h[e]]^=y,j.push(h[e])));if(c=_,h=j,l)for(e=0;e<w.length;e++)u[v][r=w[e]]&y&&(u[v][r]^=y,c.push(r));else for(e=0;e<w.length;e++)u[v][r=w[e]]&y||(u[v][r]^=y,h.push(r))}else{for(e=0;e<c.length;e++)u[v][c[e]]&y&&(u[v][c[e]]&=O);for(e=0;e<h.length;e++)u[v][h[e]]&y||(u[v][h[e]]|=y)}s.forEach(function(N){N(y,v,c,h)}),Nr("filtered")}function Ie(){return vr}function Fe(){return G}function Oe(i,l){var e=[],r=er,d,c=0;for(l&&l>0&&(c=l);--r>=rr&&i>0;)u.zero(d=k[r])&&(c>0?--c:(e.push(t[d]),--i));if(a)for(r=0;r<w.length&&i>0;r++)u.zero(d=w[r])&&(c>0?--c:(e.push(t[d]),--i));return e}function Se(i,l){var e=[],r,d,c=0;if(l&&l>0&&(c=l),a)for(r=0;r<w.length&&i>0;r++)u.zero(d=w[r])&&(c>0?--c:(e.push(t[d]),--i));for(r=rr;r<er&&i>0;)u.zero(d=k[r])&&(c>0?--c:(e.push(t[d]),--i)),r++;return e}function ee(i){var l={top:Re,all:B,reduce:Xr,reduceCount:ne,reduceSum:Me,order:ue,orderNatural:Le,size:Ne,dispose:fe,remove:fe};lr.push(l);var e,r,d=8,c=se(d),h=0,L,$,q,_,j,N=or,R=or,X=!0,tr=i===or,gr;arguments.length<1&&(i=Lr),s.push(N),sr.push(Ir),E.push(Rr),Ir(z,k,0,n);function Ir(o,A,I,J){a&&(gr=I,I=z.length-o.length,J=o.length);var x=e,g=a?[]:kr(h,c),S=q,M=_,H=j,Q=h,T=0,xr=0,ir,Or,br,Er,zr,Br;for(X&&(S=H=or),X&&(M=H=or),e=new Array(h),h=0,a?r=Q?r:[]:r=Q>1?wr.arrayLengthen(r,n):kr(n,c),Q&&(br=(Or=x[0]).key);xr<J&&!((Er=i(o[xr]))>=Er);)++xr;for(;xr<J;){for(Or&&br<=Er?(zr=Or,Br=br,g[T]=h,Or=x[++T],Or&&(br=Or.key)):(zr={key:Er,value:H()},Br=Er),e[h]=zr;Er<=Br&&(ir=A[xr]+(a?gr:I),a?r[ir]?r[ir].push(h):r[ir]=[h]:r[ir]=h,zr.value=S(zr.value,t[ir],!0),u.zeroExcept(ir,v,O)||(zr.value=M(zr.value,t[ir],!1)),!(++xr>=J));)Er=i(o[xr]);ie()}for(;T<Q;)e[g[T]=h]=x[T++],ie();if(a)for(var cr=0;cr<n;cr++)r[cr]||(r[cr]=[]);if(h>T)if(a)for(T=0;T<gr;++T)for(cr=0;cr<r[T].length;cr++)r[T][cr]=g[r[T][cr]];else for(T=0;T<I;++T)r[T]=g[r[T]];ir=s.indexOf(N),h>1||a?(N=Fr,R=Mr):(!h&&tr&&(h=1,e=[{key:null,value:H()}]),h===1?(N=nr,R=Z):(N=or,R=or),r=null),s[ir]=N;function ie(){if(a){h++;return}++h===c&&(g=wr.arrayWiden(g,d<<=1),r=wr.arrayWiden(r,d),c=se(d))}}function Rr(o){if(h>1||a){var A=h,I=e,J=kr(A,A),x,g,S;if(a){for(x=0,S=0;x<n;++x)if(o[x]!==mr){for(r[S]=r[x],g=0;g<r[S].length;g++)J[r[S][g]]=1;++S}r=r.slice(0,S)}else for(x=0,S=0;x<n;++x)o[x]!==mr&&(J[r[S]=r[x]]=1,++S);for(e=[],h=0,x=0;x<A;++x)J[x]&&(J[x]=h++,e.push(I[x]));if(h>1||a)if(a)for(x=0;x<S;++x)for(g=0;g<r[x].length;++g)r[x][g]=J[r[x][g]];else for(x=0;x<S;++x)r[x]=J[r[x]];else r=null;s[s.indexOf(N)]=h>1||a?(R=Mr,N=Fr):h===1?(R=Z,N=nr):R=N=or}else if(h===1){if(tr)return;for(var M=0;M<n;++M)if(o[M]!==mr)return;e=[],h=0,s[s.indexOf(N)]=N=R=or}}function Fr(o,A,I,J,x){if(!(o===y&&A===v||X)){var g,S,M,H,Q;if(a){for(g=0,H=I.length;g<H;++g)if(u.zeroExcept(M=I[g],v,O))for(S=0;S<r[M].length;S++)Q=e[r[M][S]],Q.value=q(Q.value,t[M],!1,S);for(g=0,H=J.length;g<H;++g)if(u.onlyExcept(M=J[g],v,O,A,o))for(S=0;S<r[M].length;S++)Q=e[r[M][S]],Q.value=_(Q.value,t[M],x,S);return}for(g=0,H=I.length;g<H;++g)u.zeroExcept(M=I[g],v,O)&&(Q=e[r[M]],Q.value=q(Q.value,t[M],!1));for(g=0,H=J.length;g<H;++g)u.onlyExcept(M=J[g],v,O,A,o)&&(Q=e[r[M]],Q.value=_(Q.value,t[M],x))}}function nr(o,A,I,J,x){if(!(o===y&&A===v||X)){var g,S,M,H=e[0];for(g=0,M=I.length;g<M;++g)u.zeroExcept(S=I[g],v,O)&&(H.value=q(H.value,t[S],!1));for(g=0,M=J.length;g<M;++g)u.onlyExcept(S=J[g],v,O,A,o)&&(H.value=_(H.value,t[S],x))}}function Mr(){var o,A,I;for(o=0;o<h;++o)e[o].value=j();if(a){for(o=0;o<n;++o)for(A=0;A<r[o].length;A++)I=e[r[o][A]],I.value=q(I.value,t[o],!0,A);for(o=0;o<n;++o)if(!u.zeroExcept(o,v,O))for(A=0;A<r[o].length;A++)I=e[r[o][A]],I.value=_(I.value,t[o],!1,A);return}for(o=0;o<n;++o)I=e[r[o]],I.value=q(I.value,t[o],!0);for(o=0;o<n;++o)u.zeroExcept(o,v,O)||(I=e[r[o]],I.value=_(I.value,t[o],!1))}function Z(){var o,A=e[0];for(A.value=j(),o=0;o<n;++o)A.value=q(A.value,t[o],!0);for(o=0;o<n;++o)u.zeroExcept(o,v,O)||(A.value=_(A.value,t[o],!1))}function B(){return X&&(R(),X=!1),e}function Re(o){var A=L(B(),0,e.length,o);return $.sort(A,0,A.length)}function Xr(o,A,I){return q=o,_=A,j=I,X=!0,l}function ne(){return Xr(yr.reduceIncrement,yr.reduceDecrement,Ur)}function Me(o){return Xr(yr.reduceAdd(o),yr.reduceSubtract(o),Ur)}function ue(o){L=Tr.by(A),$=Dr.by(A);function A(I){return o(I.value)}return l}function Le(){return ue(Lr)}function Ne(){return h}function fe(){var o=s.indexOf(N);return o>=0&&s.splice(o,1),o=sr.indexOf(Ir),o>=0&&sr.splice(o,1),o=E.indexOf(Rr),o>=0&&E.splice(o,1),o=lr.indexOf(l),o>=0&&lr.splice(o,1),l}return ne().orderNatural()}function Ce(){var i=ee(or),l=i.all;return delete i.all,delete i.top,delete i.order,delete i.orderNatural,delete i.size,i.value=function(){return l()[0].value},i}function te(){lr.forEach(function(l){l.dispose()});var i=p.indexOf(Jr);return i>=0&&p.splice(i,1),i=p.indexOf(Pr),i>=0&&p.splice(i,1),i=E.indexOf(Zr),i>=0&&E.splice(i,1),u.masks[v]&=O,qr()}return P}function we(){var F={reduce:k,reduceCount:b,reduceSum:D,value:V,dispose:W,remove:W},a,C,P,y,O=!0;s.push(ur),p.push(v),v(t,0);function v(w,pr){var U;if(!O)for(U=pr;U<n;++U)a=C(a,t[U],!0),u.zero(U)||(a=P(a,t[U],!1))}function ur(w,pr,U,fr,vr){var G,sr,lr;if(!O){for(G=0,lr=U.length;G<lr;++G)u.zero(sr=U[G])&&(a=C(a,t[sr],vr));for(G=0,lr=fr.length;G<lr;++G)u.only(sr=fr[G],pr,w)&&(a=P(a,t[sr],vr))}}function z(){var w;for(a=y(),w=0;w<n;++w)a=C(a,t[w],!0),u.zero(w)||(a=P(a,t[w],!1))}function k(w,pr,U){return C=w,P=pr,y=U,O=!0,F}function b(){return k(yr.reduceIncrement,yr.reduceDecrement,Ur)}function D(w){return k(yr.reduceAdd(w),yr.reduceSubtract(w),Ur)}function V(){return O&&(z(),O=!1),a}function W(){var w=s.indexOf(ur);return w>=0&&s.splice(w,1),w=p.indexOf(v),w>=0&&p.splice(w,1),F}return b()}function Ae(){return n}function xe(){return t}function Ee(F){var a=[],C=0,P=K(F||[]);for(C=0;C<n;C++)u.zeroExceptMask(C,P)&&a.push(t[C]);return a}function ze(F){if(typeof F!="function"){console.warn("onChange callback parameter must be a function!");return}return m.push(F),function(){m.splice(m.indexOf(F),1)}}function Nr(F){for(var a=0;a<m.length;a++)m[a](F)}return arguments.length?Y(arguments[0]):f}function kr(f,t){return(t<257?wr.array8:t<65537?wr.array16:wr.array32)(f)}function Hr(f){for(var t=kr(f,f),n=-1;++n<f;)t[n]=n;return t}function se(f){return f===8?256:f===16?65536:4294967296}export{Vr as c};
